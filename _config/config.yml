---
Name: sentryconfig
Only:
  moduleexists: 'phptek/sentry'
After: 
  - 'framework/*'
---

PhpTek\Sentry\Log\SentryLogger:
  dependencies:
    client: %$PhpTek\Sentry\Adaptor\RavenClient
    
PhpTek\Sentry\Adaptor\RavenClient:
  # Installs all available PHP error handlers
  # Untested when set to true
  install: false

SilverStripe\Core\Injector\Injector:
  Psr\Log\LoggerInterface:
    calls:
      - [ pushHandler, [ %$PhpTek\Sentry\Handler\SentryMonologHandler ]]
      
# Dummy for unit tests, overridden by userland config
PhpTek\Sentry\Adaptor\SentryClientAdaptor:
  opts:
    dsn: 'http://dummy:dummy@sentry.mydomain.nz/44'